[
  {
    "Id": "1138338",
    "ThreadId": "474960",
    "Html": "I'm attempting to create a custom update with a step that creates a config file in %APPDATA%. Unfortunately it seems that CustomUpdateEngine doesn't expand the variable. Is there a syntax to make it expand or is this feature not present?<br />\n",
    "PostedDate": "2013-12-19T09:53:39.243-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1138413",
    "ThreadId": "474960",
    "Html": "Can you post the file : C:\\Windows\\Temp\\CustomUpdateEngine.log<br />\n",
    "PostedDate": "2013-12-19T10:51:57.933-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1140297",
    "ThreadId": "474960",
    "Html": "I changed %APPDATA% to %ALLUSERSPROFILE% (which makes more sense) but I get the same result. The file gets created in &quot;C:\\Windows\\SoftwareDistribution\\Download\\Install\\%ALLUSERSPROFILE%&quot; on Win7. \r<br />\n<br />\nI'm also getting an MSI error (1619), but that's another issue... \r<br />\n<br />\n12/20/2013 9:37:22 AM\t========================================================================================================================\r<br />\n12/20/2013 9:37:22 AM\tStarting CustomUpdateEngine with ActionFile : af32ad23-cba3-4e95-8b69-2e698da68066.xml\r<br />\n12/20/2013 9:37:22 AM\tStarting parsing ActionFile.\r<br />\n12/20/2013 9:37:22 AM\tGet Element from : &lt;Action&gt;\r<br />\n&lt;ElementType&gt;CustomUpdateElements.VariableElement&lt;/ElementType&gt;\r<br />\n&lt;Name&gt;InstallerCode&lt;/Name&gt;\r<br />\n&lt;Type&gt;Int&lt;/Type&gt;\r<br />\n&lt;ID&gt;4345b3d4-11e2-4ec3-95e7-c7cab8fb8d07&lt;/ID&gt;\r<br />\n&lt;/Action&gt;\r<br />\n12/20/2013 9:37:22 AM\tGet VariableElement from : &lt;Action&gt;\r<br />\n&lt;ElementType&gt;CustomUpdateElements.VariableElement&lt;/ElementType&gt;\r<br />\n&lt;Name&gt;InstallerCode&lt;/Name&gt;\r<br />\n&lt;Type&gt;Int&lt;/Type&gt;\r<br />\n&lt;ID&gt;4345b3d4-11e2-4ec3-95e7-c7cab8fb8d07&lt;/ID&gt;\r<br />\n&lt;/Action&gt;\r<br />\n12/20/2013 9:37:22 AM\tGet Element from : &lt;Action&gt;\r<br />\n&lt;ElementType&gt;CustomUpdateElements.ExecutableElement&lt;/ElementType&gt;\r<br />\n&lt;PathToExecutable&gt;TCClient_Install.exe&lt;/PathToExecutable&gt;\r<br />\n&lt;Parameters&gt;/S /v/qn&lt;/Parameters&gt;\r<br />\n&lt;KillProcess&gt;True&lt;/KillProcess&gt;\r<br />\n&lt;TimeBeforeKilling&gt;10&lt;/TimeBeforeKilling&gt;\r<br />\n&lt;Variable&gt;4345b3d4-11e2-4ec3-95e7-c7cab8fb8d07&lt;/Variable&gt;\r<br />\n&lt;/Action&gt;\r<br />\n12/20/2013 9:37:22 AM\tGet ExecutableElement from : &lt;Action&gt;\r<br />\n&lt;ElementType&gt;CustomUpdateElements.ExecutableElement&lt;/ElementType&gt;\r<br />\n&lt;PathToExecutable&gt;TCClient_Install.exe&lt;/PathToExecutable&gt;\r<br />\n&lt;Parameters&gt;/S /v/qn&lt;/Parameters&gt;\r<br />\n&lt;KillProcess&gt;True&lt;/KillProcess&gt;\r<br />\n&lt;TimeBeforeKilling&gt;10&lt;/TimeBeforeKilling&gt;\r<br />\n&lt;Variable&gt;4345b3d4-11e2-4ec3-95e7-c7cab8fb8d07&lt;/Variable&gt;\r<br />\n&lt;/Action&gt;\r<br />\n12/20/2013 9:37:22 AM\tInstance ExecutableElement successful.\r<br />\n12/20/2013 9:37:22 AM\tGet Element from : &lt;Action&gt;\r<br />\n&lt;ElementType&gt;CustomUpdateElements.TextFileElement&lt;/ElementType&gt;\r<br />\n&lt;Filepath&gt;%ALLUSERSPROFILE%\\Hawkeye Technology\\TimeClick&lt;/Filepath&gt;\r<br />\n&lt;Filename&gt;TimeClickWS.ini&lt;/Filename&gt;\r<br />\n&lt;FileContent&gt;[Session_Default]\r<br />\nCreation Order=0\r<br />\nName=Default\r<br />\nDescription=Auto-Created Default Session\r<br />\nType=0\r<br />\nForce Buffer Flush=0\r<br />\nKeep Tables Open=0\r<br />\nRow Lock Protocol=1\r<br />\nRow Lock Retry Count=15\r<br />\nRow Lock Wait Time=100\r<br />\nRow Change Detection=0\r<br />\nProgress Interval=1000\r<br />\nConfiguration In Memory=0\r<br />\nConfiguration Name=TCDBConfig\r<br />\nLarge File Support=0\r<br />\nStandard NULL Behavior=1\r<br />\nMaximum Log File Size=1048576\r<br />\nLog Information Events=1\r<br />\nLog Warning Events=1\r<br />\nLog Error Events=1\r<br />\nCatalog Name=TCDBDatabase\r<br />\nConfiguration File Extension=.TCDBCfg\r<br />\nLock Files Extension=.TCDBLck\r<br />\nLog File Extension=.TCDBLog\r<br />\nBackup Files Extension=.TCDBBkp\r<br />\nUpdate Files Extension=.TCDBUpd\r<br />\nCatalog Files Extension=.TCDBCat\r<br />\nTable Files Extension=.TCDBTbl\r<br />\nTable Index Files Extension=.TCDBIdx\r<br />\nTable BLOB Files Extension=.TCDBBlb\r<br />\nTable Publish Files Extension=.TCDBPbl\r<br />\nRemote Compression=0\r<br />\nRemote Host=XXX.X.X.X\r<br />\nRemote Address=192.1.1.4\r<br />\nRemote Port=12010\r<br />\nRemote Service= \r<br />\nRemote Encryption=0\r<br />\nRemote Timeout=180\r<br />\nRemote Ping=1\r<br />\nRemote Ping Interval=60\r<br />\n&lt;/FileContent&gt;\r<br />\n&lt;Variable /&gt;\r<br />\n&lt;/Action&gt;\r<br />\n12/20/2013 9:37:22 AM\tGet TextFileElement from : &lt;Action&gt;\r<br />\n&lt;ElementType&gt;CustomUpdateElements.TextFileElement&lt;/ElementType&gt;\r<br />\n&lt;Filepath&gt;%ALLUSERSPROFILE%\\Hawkeye Technology\\TimeClick&lt;/Filepath&gt;\r<br />\n&lt;Filename&gt;TimeClickWS.ini&lt;/Filename&gt;\r<br />\n&lt;FileContent&gt;[Session_Default]\r<br />\nCreation Order=0\r<br />\nName=Default\r<br />\nDescription=Auto-Created Default Session\r<br />\nType=0\r<br />\nForce Buffer Flush=0\r<br />\nKeep Tables Open=0\r<br />\nRow Lock Protocol=1\r<br />\nRow Lock Retry Count=15\r<br />\nRow Lock Wait Time=100\r<br />\nRow Change Detection=0\r<br />\nProgress Interval=1000\r<br />\nConfiguration In Memory=0\r<br />\nConfiguration Name=TCDBConfig\r<br />\nLarge File Support=0\r<br />\nStandard NULL Behavior=1\r<br />\nMaximum Log File Size=1048576\r<br />\nLog Information Events=1\r<br />\nLog Warning Events=1\r<br />\nLog Error Events=1\r<br />\nCatalog Name=TCDBDatabase\r<br />\nConfiguration File Extension=.TCDBCfg\r<br />\nLock Files Extension=.TCDBLck\r<br />\nLog File Extension=.TCDBLog\r<br />\nBackup Files Extension=.TCDBBkp\r<br />\nUpdate Files Extension=.TCDBUpd\r<br />\nCatalog Files Extension=.TCDBCat\r<br />\nTable Files Extension=.TCDBTbl\r<br />\nTable Index Files Extension=.TCDBIdx\r<br />\nTable BLOB Files Extension=.TCDBBlb\r<br />\nTable Publish Files Extension=.TCDBPbl\r<br />\nRemote Compression=0\r<br />\nRemote Host=XXX.X.X.X\r<br />\nRemote Address=192.1.1.4\r<br />\nRemote Port=12010\r<br />\nRemote Service= \r<br />\nRemote Encryption=0\r<br />\nRemote Timeout=180\r<br />\nRemote Ping=1\r<br />\nRemote Ping Interval=60\r<br />\n&lt;/FileContent&gt;\r<br />\n&lt;Variable /&gt;\r<br />\n&lt;/Action&gt;\r<br />\n12/20/2013 9:37:22 AM\tEnd of Initializing of TextFileElement.\r<br />\n12/20/2013 9:37:22 AM\tGet Element from : &lt;Action&gt;\r<br />\n&lt;ElementType&gt;CustomUpdateElements.ReturnCodeElement&lt;/ElementType&gt;\r<br />\n&lt;ReturnCodeMethod&gt;Variable&lt;/ReturnCodeMethod&gt;\r<br />\n&lt;StaticReturnCode&gt;0&lt;/StaticReturnCode&gt;\r<br />\n&lt;Variable&gt;4345b3d4-11e2-4ec3-95e7-c7cab8fb8d07&lt;/Variable&gt;\r<br />\n&lt;/Action&gt;\r<br />\n12/20/2013 9:37:22 AM\tInitializing ReturnCodeElement with : &lt;Action&gt;\r<br />\n&lt;ElementType&gt;CustomUpdateElements.ReturnCodeElement&lt;/ElementType&gt;\r<br />\n&lt;ReturnCodeMethod&gt;Variable&lt;/ReturnCodeMethod&gt;\r<br />\n&lt;StaticReturnCode&gt;0&lt;/StaticReturnCode&gt;\r<br />\n&lt;Variable&gt;4345b3d4-11e2-4ec3-95e7-c7cab8fb8d07&lt;/Variable&gt;\r<br />\n&lt;/Action&gt;\r<br />\n12/20/2013 9:37:22 AM\tRunning 3 Elements.\r<br />\n12/20/2013 9:37:22 AM\tRunning CustomUpdateEngine.ExecutableElement\r<br />\n12/20/2013 9:37:22 AM\tRunning ExecutableElement.\r<br />\n12/20/2013 9:37:22 AM\tPath To Executable starting with : TCClient_Install.exe\r<br />\n12/20/2013 9:37:22 AM\tPath To Executable ending with : TCClient_Install.exe\r<br />\n12/20/2013 9:37:22 AM\tRunning : TCClient_Install.exe With arguments : /S /v/qn\r<br />\n12/20/2013 9:37:27 AM\tExiting process.\r<br />\n12/20/2013 9:37:27 AM\tEnd of running ExecutableElement.\r<br />\n12/20/2013 9:37:27 AM\tRunning CustomUpdateEngine.TextFileElement\r<br />\n12/20/2013 9:37:27 AM\tRunning TextFileElement.\r<br />\n12/20/2013 9:37:27 AM\tText file writed successfully.\r<br />\n12/20/2013 9:37:27 AM\tEnd of TextFileElement.\r<br />\n12/20/2013 9:37:27 AM\tRunning CustomUpdateEngine.ReturnCodeElement\r<br />\n12/20/2013 9:37:27 AM\tReturn Code Method is : Variable\r<br />\n12/20/2013 9:37:27 AM\tReturning :  1619<br />\n",
    "PostedDate": "2013-12-20T06:50:19.507-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1140411",
    "ThreadId": "474960",
    "Html": "This is because these custom actions doesn't expand Environnement Variables. Please send me an email to <a href=\"mailto:package.publisher@free.fr\" rel=\"nofollow\">package.publisher@free.fr</a>. I will reply with a new release of WPP that can do that. You will have delete the old update and do it again with this version.<br />\n",
    "PostedDate": "2013-12-20T12:31:17.03-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": "2014-01-17T07:54:46.447-08:00"
  }
]