[
  {
    "Id": "1069694",
    "ThreadId": "450388",
    "Html": "Took me a little trial and error to get Java 7 Update 25 working with UAC enabled; I thought I'd post my abridged notes below as an addendum to the wonderful documentation that is already provided for Java 7 update 21 under the Documentation section on this site. All praise to the devs!<br />\n<br />\nJava 7 Update 25 32-bit Install Notes:<br />\nFirst install standard Java package from Sun.<br />\n<br />\nObtain Cab and MSI from LocalLow\\Sun for current user Appdata. This is necesary because as of 7U25, the EXE fails to execute with UAC enabled. (Error 643 I believe - I tested executing the installer from the command line and observed failure as well with UAC enabled while using the switches from the 7U21 Documentation.)<br />\n<br />\nThen get install strings:<br />\nInstall Strings Located: HKEY_LOCAL_MACHINE\\Software\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall[ProductCode]<br />\n<br />\nBrowse through for Java and updater codes.<br />\n<br />\n7u25 string:<br />\n{b3789310-29f5-478f-9353-b2c9f1c711f6}<br />\n<br />\n7u25 updater string:<br />\n{4A03706F-666A-4037-7777-5F2748764D10}<br />\n<br />\nFollow Guide included mostly, but...<br />\n<br />\nDefine Return Code<br />\n<br />\nStop Service JavaQuickStarterService<br />\n<br />\nAllow to execute a file with following strings:<br />\nPath to file:<br />\n%windir%\\System32\\msiexec.exe<br />\nParameters:<br />\n/i jre1.7.0_25.msi /quiet /norestart AUTOUPDATECHECK=0 IEXPLORER=1 JAVAUPDATE=0 JU=0<br />\nKill process after 30 minutes, return code<br />\n<br />\n(This Autoupdater is not installed using these strings; while I prefer to use the .EXE Java installer because it checks for prerequisites I believe, I could not get it to work under UAC, it seemed to pass the switches straight to the MSI instead of the .exe.)<br />\n<br />\nAllow to define the return code for this custom update, then done with building, follow guide.<br />\n<br />\nTo test, approve for WSUS test group; you have to stop Windows Update service, delete datastore and download folder contents sometimes to flush deleted updates from local cache in C:\\Windows\\SoftwareDistribution. (leave folders)<br />\n<br />\nJava 7 Update 25 64-bit Install Notes:<br />\nFirst install standard Java package from Sun.<br />\nThen get install strings:<br />\nInstall Strings Located: HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall[ProductCode]<br />\n<br />\nBrowse through for Java and updater codes.<br />\n<br />\n7u25 x64 string:<br />\n{26A24AE4-039D-4CA4-87B4-2F86417025FF}<br />\n<br />\n7u25 updater string:<br />\nCurrently not present in 64-bit version of Java, see Java release.<br />\n<br />\nOtherwise follow instructions included from WSUS Package Publisher Java document.<br />\n<br />\nTo test, approve for test group; you have to stop Windows Update service, delete datastore and download folder contents. (leave folders)<br />\n",
    "PostedDate": "2013-07-17T12:57:31.887-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": "2013-10-12T08:49:12.44-07:00"
  },
  {
    "Id": "1086377",
    "ThreadId": "450388",
    "Html": "Hello,\r<br />\n<br />\nGood post, but could you please clarify a bit all steps that needs to be done to deploy Java 7 update 25 (64bit).\r<br />\n<br />\nI've just installed WSUS Package Publisher using manual for Java 7_up21 and obviously got an error 643.\r<br />\n<br />\nIs there only updater code should be changed or I missed something?\r<br />\n<br />\nThank you.<br />\n",
    "PostedDate": "2013-08-29T15:28:27.997-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1086690",
    "ThreadId": "450388",
    "Html": "SergeyL,\r<br />\n<br />\nThe 64-bit installer went according to the WSUS Package Publisher manual for me except a few minor changes i made; I did not remove the quick start service, and I did not remove the auto-updater (7u25 x64 does not have one right now.) The installed/installable string was different, I used {26A24AE4-039D-4CA4-87B4-2F86417025FF}, and followed the guide otherwise. Try dumping your software distribution database and downloads folders after stopping the windows update service, then retry building the update following the guide? Sorry I did not encounter your issue with the 64-bit version of the installer; I encountered many an issue with the 32-bit installer.<br />\n<pre><code>alreadyinstalledJava7u24x64.rules:\n&lt;msiar:MsiProductInstalled ProductCode=&quot;{26a24ae4-039d-4ca4-87b4-2f86417025ff}&quot;/&gt;\n\ninstallableJava7u25x64.rules:\n&lt;lar:And&gt;\n&lt;bar:Processor Architecture=&quot;9&quot;/&gt;&lt;lar:Not&gt;\n&lt;msiar:MsiProductInstalled ProductCode=&quot;{26a24ae4-039d-4ca4-87b4-2f86417025ff}&quot;/&gt;\n&lt;/lar:Not&gt;&lt;/lar:And&gt;\n\n.xml from completed cab:\n&lt;CustomUpdate&gt;\n&lt;Action&gt;\n&lt;ElementType&gt;CustomUpdateElements.VariableElement&lt;/ElementType&gt;\n&lt;Name&gt;Return Code&lt;/Name&gt;\n&lt;Type&gt;Int&lt;/Type&gt;\n&lt;ID&gt;245757a2-cf33-43ee-80ea-f283568c6d35&lt;/ID&gt;\n&lt;/Action&gt;\n&lt;Action&gt;\n&lt;ElementType&gt;CustomUpdateElements.ServiceElement&lt;/ElementType&gt;\n&lt;ServiceAction&gt;Stop&lt;/ServiceAction&gt;\n&lt;ServiceName&gt;JavaQuickStartService&lt;/ServiceName&gt;\n&lt;PathToEXE&gt;&lt;/PathToEXE&gt;\n&lt;StartupMode&gt;Undefined&lt;/StartupMode&gt;\n&lt;StartingAccount&gt;Undefined&lt;/StartingAccount&gt;\n&lt;Login&gt;&lt;/Login&gt;\n&lt;Password&gt;&lt;/Password&gt;\n&lt;/Action&gt;\n&lt;Action&gt;\n&lt;ElementType&gt;CustomUpdateElements.ExecutableElement&lt;/ElementType&gt;\n&lt;PathToExecutable&gt;jre-7u25-windows-x64.exe&lt;/PathToExecutable&gt;\n&lt;Parameters&gt;/s IExplorer=1&lt;/Parameters&gt;\n&lt;KillProcess&gt;True&lt;/KillProcess&gt;\n&lt;TimeBeforeKilling&gt;30&lt;/TimeBeforeKilling&gt;\n&lt;Variable&gt;245757a2-cf33-43ee-80ea-f283568c6d35&lt;/Variable&gt;\n&lt;/Action&gt;\n&lt;Action&gt;\n&lt;ElementType&gt;CustomUpdateElements.WaitElement&lt;/ElementType&gt;\n&lt;Wait&gt;30&lt;/Wait&gt;\n&lt;/Action&gt;\n&lt;Action&gt;\n&lt;ElementType&gt;CustomUpdateElements.ReturnCodeElement&lt;/ElementType&gt;\n&lt;ReturnCodeMethod&gt;Variable&lt;/ReturnCodeMethod&gt;\n&lt;StaticReturnCode&gt;0&lt;/StaticReturnCode&gt;\n&lt;Variable&gt;245757a2-cf33-43ee-80ea-f283568c6d35&lt;/Variable&gt;\n&lt;/Action&gt;\n&lt;/CustomUpdate&gt;\n</code></pre>\n\nHope this helps, best of luck!<br />\n<ul>\n<li>Dave</li>\n</ul>\n",
    "PostedDate": "2013-08-30T08:20:59.573-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]