[
  {
    "Id": "1311563",
    "ThreadId": "569323",
    "Html": "Deploying hotfixes via WSUS is something I do a lot, I'm not sure about others, but right now the process is a bit tedious and repetitive.\r<br />\nSomething interesting is that there are detection logic and installation instructions contained within the MSU files. I'm wondering if there's some way to use those to generate the appropriate XML file for customupdatepublisher and fill in some of the metadata for the update, including the applicability and installed rules, from the information contained in the MSU file.\r<br />\nThis is just the start of my looking into the workings of MSU files beyond just using the included CAB files with pkgmgr/dism. I wouldn't mind doing more research on this subject if it's an unknown for all involved.<br />\n",
    "PostedDate": "2014-10-08T07:18:28.987-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1311615",
    "ThreadId": "569323",
    "Html": "Do you have any documentation on MSU files ? What steps are you using now to deploy msu files ?<br />\n",
    "PostedDate": "2014-10-08T09:55:13.493-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1318708",
    "ThreadId": "569323",
    "Html": "I've looked for the MSU authoring documentation to see if there's a standard that they adhere to, but work and life have been keeping me from pursuing this, so no, I haven't found the documentation required to put together an automatic MSU repackager with a high level of confidence.<br />\n<br />\nHere's an example of how I deploy hotfixes from my documentation, this is for KB2462317, which is applicable to the 64-bit versions of Windows Vista, 7, Server 2008, and Server 2008 R2:<br />\n<br />\nInstall Command:<br />\n  Windows 7:<br />\n<pre><code>%systemroot%\\system32\\dism.exe /online /add-package /packagepath:.\\Windows6.1-KB2462317-v2-x64.cab /quiet /norestart /logpath:%systemroot%\\temp\\KB2462317.log /loglevel:2</code></pre>\n\nWindows Vista:<br />\n<pre><code>%systemroot%\\system32\\pkgmgr.exe /ip /m:.\\Windows6.0-KB2462317-x64.cab /quiet /norestart</code></pre>\n\nInstalled Detection:<br />\n  windows version equalto 6.0/6.1<br />\n  select * from Win32_QuickFixEngineering where hotfixid = &quot;kb2462317&quot;<br />\n<br />\nUpdate File:<br />\n  CustomUpdateEngine.exe<br />\nAdditional Files:<br />\n  Windows 7:<br />\n<pre><code>7-x64-2880-R2-x64\\kb2462317.xml\n7-x64-2880-R2-x64\\Windows6.1-KB2462317-v2-x64.cab</code></pre>\n\nWindows Vista:<br />\n<pre><code>Vista-x64-2008-x64\\kb2462317.xml\nVista-x64-2008-x64\\Windows6.1-KB2462317-v2-x64.cab</code></pre>\n\nUpdate Info:<br />\n  Vendor Name:<br />\n<pre><code>Microsoft</code></pre>\n\nProduct Name:<br />\n<pre><code>Windows</code></pre>\n\nTitle:<br />\n<pre><code>Update for Windows 7 x64 and 2008 R2 x64 (KB2462317)\nUpdate for Windows Vista x64 and Windows Server 2008 x64(KB2462317)</code></pre>\n\nDescription:<br />\nThis hotfix fixes the following issue:<br />\nWhen printing to a networked XPS printer, you experience a longer time than usual to print the documents. For example, it may take from 5 to 10 minutes to print a document that usually takes 10 seconds to print. Additionally, some large spool files that are several megabytes in size are generated when the print jobs are processed.<br />\n  More Info URL:<br />\n<pre><code>http://support.microsoft.com/kb/2462317</code></pre>\n\nPackage Type:<br />\n<pre><code>Update</code></pre>\n\nReboot Behavior:<br />\n<pre><code>CanRequestReboot</code></pre>\n\nReturn Codes:<br />\n<pre><code>{\n  Value: 0\n  Result: Succeeded\n  Need Reboot: Unchecked\n}\n{\n  Value: 3010\n  Result: Succeeded\n  Need Reboot: Checked\n}</code></pre>\n\nCommand Line:<br />\n<pre><code>\\actionfile=kb2462317.xml\n</code></pre>\n\nUpdate is installed:<br />\n  Windows 7 x64/Server 2008 R2 x64:<br />\n<pre><code>Load the rules file &quot;installed 6.1.rules&quot; into the Update level rules AND section</code></pre>\n\nWindows Vista x64/Server 2008 x64:<br />\n<pre><code>Load the rules file &quot;installed 6.0.rules&quot; into the Update level rules AND section</code></pre>\n\nCheck &quot;Delete Rules at Package Level&quot;<br />\n<br />\nUpdate is installable:<br />\n  Windows 7 x64/Server 2008 R2 x64:<br />\n<pre><code>Load the rules file &quot;installable 6.1.rules&quot; into the Update level rules AND section</code></pre>\n\nWindows Vista x64/Server 2008 x64:<br />\n<pre><code>Load the rules file &quot;installable 6.0.rules&quot; into the Update level rules AND section</code></pre>\n\nCheck &quot;Delete Rules at Package Level&quot;<br />\nPublish update and make visible in WSUS console<br />\n<br />\nI extracted the files<br />\n  7-x64-2880-R2-x64\\Windows6.1-KB2462317-v2-x64.cab<br />\n  Vista-x64-2008-x64\\Windows6.1-KB2462317-v2-x64.cab<br />\nfrom the MSU using 7zip, but they can also be extracted using expand.<br />\n<br />\nHere are the files referenced above:<br />\n7-x64-2880-R2-x64\\kb2462317.xml<br />\n<pre><code>&lt;CustomUpdate&gt;\n&lt;Action&gt;\n&lt;ElementType&gt;CustomUpdateElements.VariableElement&lt;/ElementType&gt;\n&lt;Name&gt;Return Code&lt;/Name&gt;\n&lt;Type&gt;Int&lt;/Type&gt;\n&lt;ID&gt;37311fe4-0323-438d-8723-3edd6ea1c357&lt;/ID&gt;\n&lt;/Action&gt;\n&lt;Action&gt;\n&lt;ElementType&gt;CustomUpdateElements.ExecutableElement&lt;/ElementType&gt;\n&lt;PathToExecutable&gt;%systemroot%\\system32\\dism.exe&lt;/PathToExecutable&gt;\n&lt;Parameters&gt;/online /add-package /packagepath:.\\Windows6.1-KB2462317-v2-x64.cab /quiet /norestart /logpath:%systemroot%\\temp\\KB2462317.log /loglevel:2&lt;/Parameters&gt;\n&lt;KillProcess&gt;True&lt;/KillProcess&gt;\n&lt;TimeBeforeKilling&gt;10&lt;/TimeBeforeKilling&gt;\n&lt;Variable&gt;37311fe4-0323-438d-8723-3edd6ea1c357&lt;/Variable&gt;\n&lt;/Action&gt;\n&lt;Action&gt;\n&lt;ElementType&gt;CustomUpdateElements.ReturnCodeElement&lt;/ElementType&gt;\n&lt;ReturnCodeMethod&gt;Variable&lt;/ReturnCodeMethod&gt;\n&lt;StaticReturnCode&gt;0&lt;/StaticReturnCode&gt;\n&lt;Variable&gt;37311fe4-0323-438d-8723-3edd6ea1c357&lt;/Variable&gt;\n&lt;/Action&gt;\n&lt;/CustomUpdate&gt;</code></pre>\n\nVista-x64-2008-x64\\kb2462317.xml<br />\n<pre><code>&lt;CustomUpdate&gt;\n&lt;Action&gt;\n&lt;ElementType&gt;CustomUpdateElements.VariableElement&lt;/ElementType&gt;\n&lt;Name&gt;Return Code&lt;/Name&gt;\n&lt;Type&gt;Int&lt;/Type&gt;\n&lt;ID&gt;37311fe4-0323-438d-8723-3edd6ea1c357&lt;/ID&gt;\n&lt;/Action&gt;\n&lt;Action&gt;\n&lt;ElementType&gt;CustomUpdateElements.ExecutableElement&lt;/ElementType&gt;\n&lt;PathToExecutable&gt;%systemroot%\\system32\\pkgmgr.exe&lt;/PathToExecutable&gt;\n&lt;Parameters&gt;/ip /m:.\\Windows6.0-KB2462317-x64.cab /quiet /norestart&lt;/Parameters&gt;\n&lt;KillProcess&gt;True&lt;/KillProcess&gt;\n&lt;TimeBeforeKilling&gt;10&lt;/TimeBeforeKilling&gt;\n&lt;Variable&gt;37311fe4-0323-438d-8723-3edd6ea1c357&lt;/Variable&gt;\n&lt;/Action&gt;\n&lt;Action&gt;\n&lt;ElementType&gt;CustomUpdateElements.ReturnCodeElement&lt;/ElementType&gt;\n&lt;ReturnCodeMethod&gt;Variable&lt;/ReturnCodeMethod&gt;\n&lt;StaticReturnCode&gt;0&lt;/StaticReturnCode&gt;\n&lt;Variable&gt;37311fe4-0323-438d-8723-3edd6ea1c357&lt;/Variable&gt;\n&lt;/Action&gt;\n&lt;/CustomUpdate&gt;</code></pre>\n\ninstallable 6.0.rules<br />\n<pre><code>&lt;bar:Processor Architecture=&quot;9&quot;/&gt;&lt;bar:WindowsVersion Comparison=&quot;EqualTo&quot; MajorVersion=&quot;6&quot; MinorVersion=&quot;0&quot;/&gt;&lt;lar:Not&gt;&lt;bar:WmiQuery Namespace=&quot;root\\CIMV2&quot; WqlQuery=&quot;select * from Win32_QuickFixEngineering where hotfixid = &amp;quot;kb2462317&amp;quot;&quot;/&gt;&lt;/lar:Not&gt;</code></pre>\n\ninstallable 6.1.rules<br />\n<pre><code>&lt;bar:Processor Architecture=&quot;9&quot;/&gt;&lt;bar:WindowsVersion Comparison=&quot;EqualTo&quot; MajorVersion=&quot;6&quot; MinorVersion=&quot;1&quot;/&gt;&lt;lar:Not&gt;&lt;bar:WmiQuery Namespace=&quot;root\\CIMV2&quot; WqlQuery=&quot;select * from Win32_QuickFixEngineering where hotfixid = &amp;quot;kb2462317&amp;quot;&quot;/&gt;&lt;/lar:Not&gt;</code></pre>\n\ninstalled 6.0.rules<br />\n<pre><code>&lt;bar:WmiQuery Namespace=&quot;root\\CIMV2&quot; WqlQuery=&quot;select * from Win32_QuickFixEngineering where hotfixid = &amp;quot;kb2462317&amp;quot;&quot;/&gt;&lt;bar:Processor Architecture=&quot;9&quot;/&gt;&lt;bar:WindowsVersion Comparison=&quot;EqualTo&quot; MajorVersion=&quot;6&quot; MinorVersion=&quot;0&quot;/&gt;</code></pre>\n\ninstalled 6.1.rules<br />\n<pre><code>&lt;bar:WmiQuery Namespace=&quot;root\\CIMV2&quot; WqlQuery=&quot;select * from Win32_QuickFixEngineering where hotfixid = &amp;quot;kb2462317&amp;quot;&quot;/&gt;&lt;bar:Processor Architecture=&quot;9&quot;/&gt;&lt;bar:WindowsVersion Comparison=&quot;EqualTo&quot; MajorVersion=&quot;6&quot; MinorVersion=&quot;1&quot;/&gt;</code></pre>\n\n",
    "PostedDate": "2014-11-03T12:26:16.967-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]